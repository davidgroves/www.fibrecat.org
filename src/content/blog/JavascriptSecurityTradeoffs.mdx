---
title: CLI Arguments from the Bottom Up.
description: Understanding how programs parse CLI arguments, but from the bottom up.
pubDate: 28 June 2024
heroImage: ../../assets/blog/JSPadlockLogo.png
heroCredit: AI Generated by Stable Diffusion.
heroLink: https://stability.ai/
heroAltText: A padlock with the letters JS on it as a logo.
---
import { Image } from 'astro:assets';

## No win situaions in security.

Some security situations simply don't have a "correct" answer. You are working with a series of tradeoffs and you have to make a decision. Sometimes these are security vs useabilty tradeoffs, but sometimes they are straight up exchanges of one security risk for another.

## Blog inspiration.

This blog was inspired by the recent security issue created by the [Polyfill.io Supply Chain Attack](https://blog.qualys.com/vulnerabilities-threat-research/2024/06/28/polyfill-io-supply-chain-attack). The projects original creator [says to stop using it](https://x.com/triblondon/status/1761852117579427975).

In summary, there was a javascript library that was popular and used by thousands of websites. The domain name used most commonly to distribute it was sold to a Chinese company, and they added malware to the library.

From the [c/side blog](https://cside.dev/blog/more-than-100k-websites-targeted-in-web-supply-chain-attack).

```
The domain was found injecting malicious code into devices via websites using cdn.polyfill.io. The malicious code dynamically generates payloads based on HTTP headers, activating only on specific mobile devices, evading detection, avoiding admin users and delaying execution. The code is also obfuscated.

In some instances, users receive tampered JavaScript files, which include a fake Google Analytics link https://www.googie-anaiytics.com/gtags.js. This fake link redirects users to various sports betting and pornographic websites, seemingly based on their region. But this being JavaScript, could at any moment introduce new attacks like formjacking, clickjacking, and broader data theft.
```

## How are these scripts loaded ?

The 






